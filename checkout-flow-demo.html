<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>結帳流程 Demo - 三步驟版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
    </style>
</head>
<body class="min-h-screen p-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">結帳</h1>
            <p class="text-gray-600">簡化的三步驟結帳流程</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- 主要結帳區域 -->
            <div class="lg:col-span-2 space-y-6">
                <!-- 進度條 -->
                <div class="bg-white rounded-xl p-6 border border-gray-100 shadow-sm">
                    <div class="flex items-center justify-between text-sm">
                        <div class="flex items-center space-x-3">
                            <div id="step1-indicator" class="w-8 h-8 rounded-full flex items-center justify-center font-medium bg-blue-500 text-white">1</div>
                            <span id="step1-text" class="font-medium text-gray-900">選擇物流</span>
                        </div>
                        <div id="progress1" class="w-16 h-px bg-gray-200"></div>
                        <div class="flex items-center space-x-3">
                            <div id="step2-indicator" class="w-8 h-8 rounded-full flex items-center justify-center font-medium bg-gray-200 text-gray-500">2</div>
                            <span id="step2-text" class="text-gray-500">填寫資料</span>
                        </div>
                        <div id="progress2" class="w-16 h-px bg-gray-200"></div>
                        <div class="flex items-center space-x-3">
                            <div id="step3-indicator" class="w-8 h-8 rounded-full flex items-center justify-center font-medium bg-gray-200 text-gray-500">3</div>
                            <span id="step3-text" class="text-gray-500">選擇付款</span>
                        </div>
                    </div>
                </div>

                <!-- 步驟 1: 選擇物流 -->
                <div id="shipping-section" class="bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden">
                    <div class="bg-gray-50 px-8 py-4 border-b border-gray-100">
                        <h3 class="text-lg font-semibold text-gray-900">步驟 1：選擇物流方式</h3>
                    </div>
                    <div class="p-8">
                        <div class="space-y-3">
                            <!-- 宅配到府 -->
                            <div class="shipping-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all" data-type="home_delivery">
                                <div class="flex w-full items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="flex items-center justify-center text-gray-700">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <div class="font-medium text-gray-900">宅配到府</div>
                                            <div class="text-sm text-gray-600 mt-1">1-3個工作天送達</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="font-medium text-gray-900">NT$100</div>
                                        <div class="option-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- 超商取貨 -->
                            <div class="shipping-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all" data-type="convenience_store">
                                <div class="flex w-full items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="w-5 h-5 bg-blue-500 rounded flex items-center justify-center text-white text-xs font-bold">超</div>
                                        <div>
                                            <div class="font-medium text-gray-900">超商取貨</div>
                                            <div class="text-sm text-gray-600 mt-1">3-5個工作天到店，7天內取貨</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="font-medium text-gray-900">NT$60</div>
                                        <div class="option-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- 門市自取 -->
                            <div class="shipping-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all" data-type="pickup">
                                <div class="flex w-full items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="w-5 h-5 bg-green-500 rounded flex items-center justify-center text-white text-xs font-bold">取</div>
                                        <div>
                                            <div class="font-medium text-gray-900">門市自取</div>
                                            <div class="text-sm text-gray-600 mt-1">到實體門市取貨，免運費</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="font-medium text-gray-900">免費</div>
                                        <div class="option-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 選擇提示 -->
                        <div id="shipping-hint" class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg hidden">
                            <div class="text-sm text-blue-800">
                                ✓ 已選擇配送方式，請點擊下方「確認選擇」按鈕繼續
                            </div>
                        </div>

                        <!-- 確認選擇按鈕 -->
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <button id="confirm-shipping-button" class="w-full bg-gray-300 text-white cursor-not-allowed font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2" disabled>
                                <span>確認選擇</span>
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 步驟 2: 填寫資料 -->
                <div id="data-section" class="bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden hidden">
                    <div class="bg-gray-50 px-8 py-4 border-b border-gray-100">
                        <h3 id="data-title" class="text-lg font-semibold text-gray-900">步驟 2：填寫資料</h3>
                        <p id="data-description" class="text-sm text-gray-600 mt-1">請填寫相關資訊</p>
                    </div>
                    <div class="p-8">
                        <!-- 宅配地址表單 -->
                        <div id="address-form" class="space-y-4 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">收件人姓名 *</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="請輸入收件人姓名">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">聯絡電話 *</label>
                                    <input type="tel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="請輸入聯絡電話">
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">縣市 *</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option>請選擇縣市</option>
                                        <option>台北市</option>
                                        <option>新北市</option>
                                        <option>桃園市</option>
                                        <option>台中市</option>
                                        <option>台南市</option>
                                        <option>高雄市</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">郵遞區號 *</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="請輸入郵遞區號">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">詳細地址 *</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="請輸入詳細地址">
                            </div>
                            <button id="address-submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors mt-6">
                                確認地址資訊
                            </button>
                        </div>

                        <!-- 超商門市選擇 -->
                        <div id="store-selector" class="space-y-4 hidden">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">選擇取貨門市</label>
                                <div class="flex gap-2 mb-4">
                                    <input type="text" placeholder="輸入地址或關鍵字搜尋" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">搜尋</button>
                                </div>
                            </div>
                            <div class="space-y-2 max-h-64 overflow-y-auto">
                                <div class="store-option border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" data-store="store1">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium text-gray-900">7-11 信義門市</div>
                                            <div class="text-sm text-gray-600">台北市信義區信義路五段7號</div>
                                            <div class="text-xs text-gray-500">距離 0.5km</div>
                                        </div>
                                        <div class="store-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                    </div>
                                </div>
                                <div class="store-option border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" data-store="store2">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium text-gray-900">全家 松高門市</div>
                                            <div class="text-sm text-gray-600">台北市信義區松高路16號</div>
                                            <div class="text-xs text-gray-500">距離 0.8km</div>
                                        </div>
                                        <div class="store-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                    </div>
                                </div>
                            </div>
                            <div id="store-selected" class="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg hidden">
                                <div class="text-sm text-green-800">
                                    ✓ 已選擇取貨門市：<span id="selected-store-name"></span>
                                </div>
                                <div class="text-xs text-green-600 mt-1">
                                    系統將自動進入下一步驟
                                </div>
                            </div>
                        </div>

                        <!-- 門市自取確認 -->
                        <div id="pickup-info" class="space-y-4 hidden">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h4 class="font-medium text-blue-900 mb-2">門市資訊</h4>
                                <p class="text-sm text-blue-800">台北旗艦店</p>
                                <p class="text-sm text-blue-700">台北市大安區忠孝東路四段1號</p>
                                <p class="text-sm text-blue-700">營業時間：週一至週日 10:00-22:00</p>
                                <p class="text-sm text-blue-700">聯絡電話：(02) 1234-5678</p>
                            </div>
                            <button id="pickup-confirm" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors">
                                確認門市資訊
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 步驟 3: 選擇付款 -->
                <div id="payment-section" class="bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden hidden">
                    <div class="bg-gray-50 px-8 py-4 border-b border-gray-100">
                        <h3 class="text-lg font-semibold text-gray-900">步驟 3：選擇付款方式</h3>
                    </div>
                    <div class="p-8">
                        <div class="space-y-3">
                            <div class="payment-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-6 bg-blue-600 rounded text-white text-xs flex items-center justify-center font-bold">VISA</div>
                                        <span class="font-medium">信用卡</span>
                                    </div>
                                    <div class="payment-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                </div>
                            </div>
                            <div class="payment-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-6 bg-green-600 rounded text-white text-xs flex items-center justify-center font-bold">LINE</div>
                                        <span class="font-medium">LINE Pay</span>
                                    </div>
                                    <div class="payment-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                </div>
                            </div>
                            <div class="payment-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-6 bg-purple-600 rounded text-white text-xs flex items-center justify-center font-bold">ATM</div>
                                        <span class="font-medium">ATM 轉帳</span>
                                    </div>
                                    <div class="payment-check w-5 h-5 border-2 border-gray-300 rounded-full"></div>
                                </div>
                            </div>
                        </div>
                        <button id="complete-order" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-4 px-4 rounded-lg transition-colors mt-6 text-lg">
                            完成訂單
                        </button>
                    </div>
                </div>
            </div>

            <!-- 訂單摘要 -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden sticky top-4">
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-100">
                        <h3 class="text-lg font-semibold text-gray-900">訂單摘要</h3>
                    </div>
                    <div class="p-6 space-y-4">
                        <!-- 商品項目 -->
                        <div class="space-y-3">
                            <div class="flex items-center gap-3">
                                <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=60&h=60&fit=crop&crop=center" alt="產品" class="w-12 h-12 rounded-lg object-cover">
                                <div class="flex-1">
                                    <div class="font-medium text-sm">經典白T恤</div>
                                    <div class="text-xs text-gray-600">尺寸: M / 數量: 1</div>
                                </div>
                                <div class="font-medium text-sm">NT$890</div>
                            </div>
                            <div class="flex items-center gap-3">
                                <img src="https://images.unsplash.com/photo-1542272604-787c3835535d?w=60&h=60&fit=crop&crop=center" alt="產品" class="w-12 h-12 rounded-lg object-cover">
                                <div class="flex-1">
                                    <div class="font-medium text-sm">休閒牛仔褲</div>
                                    <div class="text-xs text-gray-600">尺寸: 32 / 數量: 1</div>
                                </div>
                                <div class="font-medium text-sm">NT$1,590</div>
                            </div>
                        </div>

                        <hr class="border-gray-200">

                        <!-- 費用明細 -->
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">商品小計</span>
                                <span>NT$2,480</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">運費</span>
                                <span id="shipping-fee">NT$100</span>
                            </div>
                            <hr class="border-gray-200">
                            <div class="flex justify-between font-semibold text-base">
                                <span>總計</span>
                                <span id="total-amount">NT$2,580</span>
                            </div>
                        </div>

                        <!-- 信任標章 -->
                        <div class="pt-4 border-t border-gray-200">
                            <div class="flex items-center justify-center space-x-4 text-xs text-gray-500">
                                <div class="flex items-center gap-1">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
                                    </svg>
                                    <span>SSL 加密</span>
                                </div>
                                <div class="flex items-center gap-1">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                    <span>安全購物</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedShippingType = null;
        let selectedStore = null;

        // 更新進度條
        function updateProgress(step) {
            // 重置所有樣式
            for (let i = 1; i <= 3; i++) {
                const indicator = document.getElementById(`step${i}-indicator`);
                const text = document.getElementById(`step${i}-text`);
                const progress = document.getElementById(`progress${i}`);
                
                if (i < step) {
                    indicator.className = "w-8 h-8 rounded-full flex items-center justify-center font-medium bg-blue-500 text-white";
                    text.className = "font-medium text-gray-900";
                    if (progress) progress.className = "w-16 h-px bg-blue-300";
                } else if (i === step) {
                    indicator.className = "w-8 h-8 rounded-full flex items-center justify-center font-medium bg-blue-500 text-white";
                    text.className = "font-medium text-gray-900";
                } else {
                    indicator.className = "w-8 h-8 rounded-full flex items-center justify-center font-medium bg-gray-200 text-gray-500";
                    text.className = "text-gray-500";
                    if (progress) progress.className = "w-16 h-px bg-gray-200";
                }
            }
        }

        // 更新運費和總計
        function updateTotals(shippingFee) {
            document.getElementById('shipping-fee').textContent = shippingFee === 0 ? '免費' : `NT$${shippingFee}`;
            document.getElementById('total-amount').textContent = `NT$${2480 + shippingFee}`;
        }

        // 物流選擇
        document.querySelectorAll('.shipping-option').forEach(option => {
            option.addEventListener('click', function() {
                // 清除所有選項的選中狀態
                document.querySelectorAll('.shipping-option').forEach(opt => {
                    opt.className = 'shipping-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all';
                    opt.querySelector('.option-check').className = 'option-check w-5 h-5 border-2 border-gray-300 rounded-full';
                });

                // 設定當前選項為選中
                this.className = 'shipping-option bg-blue-50 border-2 border-blue-500 shadow-md rounded-lg p-4 cursor-pointer transition-all';
                const checkIcon = this.querySelector('.option-check');
                checkIcon.className = 'option-check w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center';
                checkIcon.innerHTML = '<svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>';

                selectedShippingType = this.dataset.type;
                
                // 更新運費
                const fees = { home_delivery: 100, convenience_store: 60, pickup: 0 };
                updateTotals(fees[selectedShippingType]);

                // 顯示提示和啟用確認按鈕
                document.getElementById('shipping-hint').classList.remove('hidden');
                const confirmButton = document.getElementById('confirm-shipping-button');
                confirmButton.className = 'w-full bg-gray-900 hover:bg-gray-800 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2';
                confirmButton.disabled = false;
            });
        });

        // 確認物流選擇
        document.getElementById('confirm-shipping-button').addEventListener('click', function() {
            if (!selectedShippingType) return;
            
            currentStep = 2;
            updateProgress(2);
            
            // 隱藏步驟1區域
            document.getElementById('shipping-section').style.opacity = '0.6';
            document.getElementById('shipping-section').style.pointerEvents = 'none';
            
            // 顯示步驟2區域
            const dataSection = document.getElementById('data-section');
            dataSection.classList.remove('hidden');
            
            // 更新標題和描述
            const titles = {
                home_delivery: '步驟 2：填寫收件地址',
                convenience_store: '步驟 2：選擇超商門市',
                pickup: '步驟 2：確認取貨門市'
            };
            const descriptions = {
                home_delivery: '請填寫完整的收件資訊',
                convenience_store: '請選擇您要取貨的超商門市',
                pickup: '請確認門市資訊與聯絡方式'
            };
            
            document.getElementById('data-title').textContent = titles[selectedShippingType];
            document.getElementById('data-description').textContent = descriptions[selectedShippingType];
            
            // 顯示對應的表單
            document.getElementById('address-form').classList.toggle('hidden', selectedShippingType !== 'home_delivery');
            document.getElementById('store-selector').classList.toggle('hidden', selectedShippingType !== 'convenience_store');
            document.getElementById('pickup-info').classList.toggle('hidden', selectedShippingType !== 'pickup');
            
            // 滾動到步驟2
            dataSection.scrollIntoView({ behavior: 'smooth' });
        });

        // 超商門市選擇
        document.querySelectorAll('.store-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.store-option').forEach(opt => {
                    opt.className = 'store-option border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors';
                    opt.querySelector('.store-check').className = 'store-check w-5 h-5 border-2 border-gray-300 rounded-full';
                });

                this.className = 'store-option border-2 border-blue-500 bg-blue-50 rounded-lg p-3 cursor-pointer transition-colors';
                const checkIcon = this.querySelector('.store-check');
                checkIcon.className = 'store-check w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center';
                checkIcon.innerHTML = '<svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>';

                selectedStore = this.dataset.store;
                document.getElementById('selected-store-name').textContent = this.querySelector('.font-medium').textContent;
                document.getElementById('store-selected').classList.remove('hidden');

                setTimeout(() => {
                    goToPayment();
                }, 1500);
            });
        });

        // 地址表單提交
        document.getElementById('address-submit').addEventListener('click', function() {
            goToPayment();
        });

        // 門市確認
        document.getElementById('pickup-confirm').addEventListener('click', function() {
            goToPayment();
        });

        // 進入付款步驟
        function goToPayment() {
            currentStep = 3;
            updateProgress(3);
            
            // 隱藏步驟2區域
            document.getElementById('data-section').style.opacity = '0.6';
            document.getElementById('data-section').style.pointerEvents = 'none';
            
            // 顯示步驟3區域
            const paymentSection = document.getElementById('payment-section');
            paymentSection.classList.remove('hidden');
            paymentSection.scrollIntoView({ behavior: 'smooth' });
        }

        // 付款方式選擇
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.payment-option').forEach(opt => {
                    opt.className = 'payment-option border border-gray-300 bg-white rounded-lg p-4 cursor-pointer hover:border-gray-400 hover:shadow-sm transition-all';
                    opt.querySelector('.payment-check').className = 'payment-check w-5 h-5 border-2 border-gray-300 rounded-full';
                });

                this.className = 'payment-option bg-blue-50 border-2 border-blue-500 shadow-md rounded-lg p-4 cursor-pointer transition-all';
                const checkIcon = this.querySelector('.payment-check');
                checkIcon.className = 'payment-check w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center';
                checkIcon.innerHTML = '<svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>';
            });
        });

        // 完成訂單
        document.getElementById('complete-order').addEventListener('click', function() {
            alert('訂單已送出！感謝您的購買。');
        });

        // 初始化
        updateProgress(1);
        updateTotals(100);
    </script>
</body>
</html>
